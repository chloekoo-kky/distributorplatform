{% extends 'base.html' %}
{% load form_tags %}

{% block title %}{{ title }}{% endblock %}

{# Hide banner/nav from base.html on this form page #}
{% block full_width_banner %}{% endblock %}
{% block full_width_sticky_nav %}{% endblock %}

{% block content %}
<div class="w-full"
     x-data="{
        tab: '#seo',
        hasUnsavedChanges: false,
        isSubmitting: false,

        confirmLeave(event) {
            console.log('[DEBUG] confirmLeave() called');
            if (this.hasUnsavedChanges && !this.isSubmitting) {
                if (!confirm('You have unsaved changes. Are you sure you want to leave?')) {
                    console.log('[DEBUG] User clicked CANCEL. Preventing navigation.');
                    event.preventDefault();
                } else {
                    console.log('[DEBUG] User clicked OK. Allowing navigation.');
                }
            } else {
                 console.log('[DEBUG] No unsaved changes. Allowing navigation.');
            }
        }
     }">

    {% include 'core/partials/manage_tabs.html' %}

    <div class="pt-8">
        <div class="w-full max-w-2xl mx-auto bg-white shadow-lg rounded-lg overflow-hidden p-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">{{ title }}</h2>

            <form method="POST"
                  @change="hasUnsavedChanges = true"
                  @submit="isSubmitting = true">

                {% csrf_token %}
                <div class="space-y-4">

                    {{ form.non_field_errors }}

                    <div>
                        <label for="{{ form.page_name.id_for_label }}" class="font-semibold text-gray-700 block mb-1">Page Name</label>
                        {{ form.page_name }}
                        <p class="text-xs text-gray-500 mt-1">{{ form.page_name.help_text }}</p>
                        {% for error in form.page_name.errors %}<p class="text-sm text-red-600 mt-1">{{ error }}</p>{% endfor %}
                    </div>
                    <div>
                        <label for="{{ form.page_path.id_for_label }}" class="font-semibold text-gray-700 block mb-1">Page Path</label>
                        {{ form.page_path }}
                        <p class="text-xs text-gray-500 mt-1">{{ form.page_path.help_text }}</p>
                        {% for error in form.page_path.errors %}<p class="text-sm text-red-600 mt-1">{{ error }}</p>{% endfor %}
                    </div>
                    <div>
                        <label for="{{ form.meta_title.id_for_label }}" class="font-semibold text-gray-700 block mb-1">Meta Title</label>
                        {{ form.meta_title }}
                        <p class="text-xs text-gray-500 mt-1">{{ form.meta_title.help_text }}</p>
                        {% for error in form.meta_title.errors %}<p class="text-sm text-red-600 mt-1">{{ error }}</p>{% endfor %}
                    </div>
                    <div>
                        <label for="{{ form.meta_description.id_for_label }}" class="font-semibold text-gray-700 block mb-1">Meta Description</label>
                        {{ form.meta_description }}
                        <p class="text-xs text-gray-500 mt-1">{{ form.meta_description.help_text }}</p>
                        {% for error in form.meta_description.errors %}<p class="text-sm text-red-600 mt-1">{{ error }}</p>{% endfor %}
                    </div>

                </div>

                <div class="mt-8 flex justify-end space-x-3">
                    <a href="{% url 'core:manage_dashboard' %}#seo"
                       @click="confirmLeave($event)"
                       class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50">
                        Cancel
                    </a>
                    <button type="submit" class="px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700">
                        Save SEO Setting
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}
